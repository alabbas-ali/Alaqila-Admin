<div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">Media</h4>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-md-12">
                    <!-- Custom Tabs -->
                    <div class="nav-tabs-custom">
                        <ul class="nav nav-tabs">

                            <li><a href="#tab_1" data-toggle="tab">Upload</a></li>
                            <li class="active"><a href="#tab_2" data-toggle="tab">Media Library</a></li>

                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane" id="tab_1">


                                <?php $form->setAttribute('action', $this->url('Myuploads')); ?>
                                <?php $form->prepare(); ?>
                                <?php echo $this->form()->openTag($form); ?>
                                <?php echo $this->formFileApcProgress(); // Must come before the file input! ?>
                                <?php //echo $this->formFileSessionProgress(); // Must come before the file input! ?>
                                <div class="form-element">
                                    <?php $fileElement = $form->get('file'); ?>
                                    <?php echo $this->formLabel($fileElement); ?>
                                    <?php echo $this->formFile($fileElement); ?>
                                    <?php echo $this->formElementErrors($fileElement); ?>
                                </div>

                                <button>Submit</button>

                                <?php echo $this->form()->closeTag(); ?>


                                <div id="progress" class="progress progress-sm active">
                                    <div class="bar progress-bar progress-bar-primary progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                        <span class="sr-only">20% Complete</span>
                                    </div>
                                </div>


                            </div><!-- /.tab-pane -->
                            <div class="tab-pane active clearfix filesdisplaytab" id="tab_2">



                            </div><!-- /.tab-pane -->
                        </div><!-- /.tab-content -->
                    </div><!-- nav-tabs-custom -->
                </div><!-- /.col -->
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
    </div>
    <!-- /.modal-content -->
</div>
<!-- /.modal-dialog -->

<script type="text/javascript">
    $(document).ready(function () {
        var page = 1;
        var end = false;

        function call() {
            if (!end) {
                $.ajax({
                    url: "<?php echo $this->url('Myuploads', array('action' => 'filesdisplay')); ?>/" + page,
                    success: function (data) {
                        $("#tab_2").append(data.files);
                        if (data.filesnum == 0) end = true;
                        page++;
                    }
                });
            }
        }
        call();
        $('#tab_2').bind('scroll', function () {
            if ($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight) {
                call();
            }
        });
    });

</script>
